<!DOCTYPE html>
<html lang="en">
<head>
  <title>flowium</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="flowium.css">
  <script src="utils.js"></script>
</head>
<script>

intro = `
In the IT industry there is certain kind of processes that are rarely executed
without a lot of trouble. They are complex, volatile, often vaguely defined
and not rarely long-lived. They have many participants and stakeholders. They
are processes like "How to get a new major release out of the door?", "How to
reconfigure the company network?" or "How to build a new datacenter?"

These processes require a huge amount of highly technical knowledge, yet they
are rarely documented and even if they are the documentation is often couple
of years out of date. The knowledge is passed down by oral tradition, it
gradually dissipates and when people leave the company it is lost forever.

Flowium is an attempt to help with this problem.

It assumes that the process
is written down as a markdown document. Then it turns the document into a tool
to guide people through the process, to track what has already been done, to
collect all the available context and to provide a well-defined communication
channel for all the participants in the process. Last but not least it tries
to encourage updating and maintenance of the original markdown document.

Technically, Flowium is a shim on top of GitHub issue tracker. It runs
entirely in the user's browser and speaks only to GitHub at the backend.
`

shoping = `
Let's start with the most trivial example. A list of items to buy at a grocery.
Here's the markdown document:

\`\`\`
# Bread

Choose a nice, crusty one.

# Butter

Don't buy to much of it else it'll get stale.

# Jam

Either strawberry or raspberry jam.
\`\`\`

You are supposed to upload your document to your GitHub repository, however,
the examples in this tutorial have already been uploaded for you, so you can
<a href="index.html?action=create&repository=sustrik%2Fflowium-sandbox&template=%2Fshopping-list.md&title=My%20shopping%20list&comment=Go%20shopping!" target="_blank">start shopping straight away</a>.

As you can see you can comment on individual steps and mark them as either
done or not done. When a step is marked as done it's color changes from green
to grey.
`

responsibility = `
Imagine that the user bought both bread and butter and marked the corresponding
steps as done. However, they've left following comment on the last step:
"I hate jam!" Then they've closed the issue.

A proper authoritarian tool would require all steps to be marked as done before
the issue could be closed. However, Flowium allows to do that. What's going
on here?

The main design principle behind Flowium is that complex processes are
inherently quirky and full of exceptions. Trying to enforce the process stricly
would just put obstacles into the user's way. The shopping list may work for
most users but once in a while you are going to run into a user who hates jam.
Or (too terrible to contemplate!) a user who eats butter and jam without bread.

Therefore, Flowium adopts a liberal attitude, allowing for arbitrary violations
of the process.

Working with Flowium thus requires a particular mindset. The user has to
understand that the tool is, for better or worse, not going to police them.
It is there to guide, to help with tracking and communication, but it's not
going to hold them back. If they screw up, there's no one else to shift the
responsibility to.
`

communication = `
Flowium is, above all, a communication tool. If, after all, there was only
one participant in the process, they could just keep the entire context in
their mind and be done with it.

Technically, the entire process is stored as a GitHub issue and is thus
accessible to any user with appropriate access rights.

The easiest way to send the issue to a colleague is to pass them the URL from
your browser. When they open it they will see which steps were already done
(marked grey) and which are still to be done (marked green). They can check
the comments and understand what kinds of obstacles you've encountered when
trying to execute the step.

An alternative way to notify a co-worker is to take advantage of GitHub
notifications. If you put someone's GitHub nick into a comment, they'll get
notified:

\`\`\`
@johndoe: Can you please take a look at this?
\`\`\`
`

audit = `
Sometimes, when investigating a failure or writing a post-mortem, you want
to see all that happened in chronological order.

Click on the "History" tab in Flowium and you'll get exactly that.

<div class="alert alert-warning" role="alert">
Flowium does not allow you to edit or delete comments. Please refrain from
doing so directly via GitHub GUI. It may not only obscure the audit trail but
also break the Flowium process.
</div>
`

dependencies = `
More often than not a step cannot be done unless a previous step was finished.

Flowium allows to formalize these dependencies by assigning short names to
individual steps and then defining which depends on which:

\`\`\`
# Make a toast ~> toast

Insert the bread into the toaster and press the lever. If the toast gets stuck
in the toaster release it by banging on the side of the toaster.

# Spread the butter ~> butter: toast

Don't use too much butter or it will drip from the toast.

# Spread the jam ~> jam: butter

Be generous with jam.
\`\`\`

The first step has short name "toast", the second one "butter" and so on.

What comes after colon are the steps that the current step depends on.
For example, \`butter: toast\` means that step \`butter\` should not be executed
before step \`toast\` is done.

<div class="alert alert-primary" role="alert">
For those familiar with make tool, yes, this is exactly the same syntax.
You can even think of Flowium as of make where individual steps are executed
by human beings rather than by a computer.
</div>

You can
<a href="index.html?action=create&repository=sustrik%2Fflowium-sandbox&template=%2Fmake-a-toast.md&title=My%20toast&comment=Make%20a%20toast!" target="_blank">play with this process here</a>.

Note that some steps are now colored red. These are the blocked steps, i.e.
steps that have at least one step they are depending on that is not yet done.
That being said, Flowium is liberal and you can mark even a blocked step as
done.

Now that we have dependencies between the steps the "Graph" tab start to make
sense. It gives you quick overview of the process, what states the individual
steps are in and what's blocking what. Clicking on a step in the graph will
navigate you the corresponding step.

<div class="alert alert-warning" role="alert">
While you may define steps without short names it's preferable not to do so.
If there's no short name, the full title of the step (or rather a hash of it)
is used as a step identifier and changing the title can break the workflow.
</div>
`

parallel = `
Especially for long-lived processes, executing all the steps one-by-one would
make the process stretch forever. We do want to execute as many steps as
possible in parallel.

Here's an example of how to do that:

\`\`\`
# Make a decision to build a datacenter ~> decide

Be frank with yourself. Do we **really** need a new datacenter?

Anyway, if we do, notify the procurement to order machines and the
construction dept. to start building the damn thing.

# Build it ~> build: decide

Build the walls first. Then the roof.

# Connect it to the grid ~> grid: build

Plug the cable in.

# Ask for quotes ~> quotes: decide

To order the machines, first ask for quotes from different vendors.

# Select a vendor ~> vendor: quotes

Pick the cheapest one.

# Make sure the machines are delivered in time ~> delivery: vendor

Contact the vendor once in a while to make sure there are no slippages.

# Install the machines ~> install: delivery grid

Machines go to racks. You also have to plug the cables in.

# Flip the switch ~> switch: install

Wait for a stormy night. Then flip the big switch.
\`\`\`

<a href="index.html?action=create&repository=sustrik%2Fflowium-sandbox&template=%2Fbuild-a-datacenter.md&title=Build%20datacenter&comment=Build%20a%20new%20one." target="_blank">Play with this process</a>.

As can be seen, splitting a flow into parallel flows requires only making
mutliple steps depend on a single one. Joining the flows is done by listing
multiple dependencies for the step.

The important thing to understand here is how parallel flows allow multiple
people to work on the same issue, to share the context, yet be sufficiently
isolated not to interfere each with another. Also, it's important to see how
the delegation of work is done.

Let's consider an example.

Carol the CEO decides to build a new datacenter. She comments on the \`quotes\'
step:

\`\`\`
@patty: Can you please order the machines for the new datacenter?
\`\`\`

Patty the Purchaser gets a GitHub notification and starts the procurement
process.

Carol also comments on the \`build\` step and asks Bob the Builder to start
building the datacenter:

\`\`\`
@bob: Hey, Bob! Can we start building it ASAP?
\`\`\`

Then she marks \`decide\` step as done.

Patty and Bob can now execute their own steps without interfering each with
another. Comments are attached to individual steps and thus Bob doesn't even
have to be aware of what's going on on the procurement side unless, of course,
he choses to have a look at those particular steps.

After they finish their work, both Patty and Bob can comment on the \`install\`
step notifying Igor the Installer that the building or, respectively,
the machines are ready.

Igor takes it from there, installs the machines and finally flips the big
switch to get the entire datacenter alive.
`

variables = `
It is possible to gather some data about the process from the user.
The data can then be used to customize further steps of the process. This is
especially usefuly when we want to construct complex commands such as
command lines. Consider this example:

\`\`\`
# Install Frobnicator

* Which version do you want to install? ~> version
* Which directory do you want to install it to? ~> directory

Execute the following line in your shell:

\`install frobnicator-#{version} --path #{directory}\`

\`\`\`

<a href="index.html?action=create&repository=sustrik%2Fflowium-sandbox&template=%2Ffrobnicator.md&title=Install%20Frobnicator" target="_blank">Play with this process</a>.

<div class="alert alert-warning" role="alert">
The names of the variables used to collect the input can contain letters, digits
and dashes. All the other characters are invalid.
</div>

<div class="alert alert-primary" role="alert">
Occasionally, you may want to inspect all the variables collected in the issue.
You may do so by opening the "More" tab, then clicking on
"Inspect the variables" link. You can also change the values of the variables
there.
`

versioning = `
Complex processes are naturally subject to change. The more complex the process
the more likely it is to change.

This can be a problem if the processes changes while some of its instances are
being executed. It's unclear what should happen. Should those in-flight
instances automatically upgrade to the new version of the process? Should they
continue using the old version?

When an issue is created with Flowium, the issue is associated with the newest
version of the process. From there on, though, it sticks with that version.

If the process (also known as "template file") is changed it doesn't effect
the issue in any way.

That in turn means that there can be multiple versions of the same process
executed at the same time. For example, one datacenter may be still being built
using the old process, while a more recent construction follows the new version
of the process.

All that being said, user can update the process version manually. Go to "More"
tab and click on "Update the template" link. Then choose the version to
upgrade to.
`

editing = `
Template files (the markdown files with process documentation) are just normal
files stored in GitHub repositories. As such they can be edited and updated
using the standard Git means.

However, it may often be less painful to go to the "More" tab and click on
"Edit the template" link. It opens GitHub's online editor, where the file can be
updated and then committed by pressing a single button.

<div class="alert alert-warning" role="alert">
Recall that Flowium processes stick to the version of the template file they
were created with. After editing the file you still have to click "Update the
template" link to start using the new version of the process.
</div>
`

////////////////////////////////////////////////////////////////////////////////
//  Error handling.
////////////////////////////////////////////////////////////////////////////////

window.addEventListener('error', function (e) {
    $("#flowium-all").hide()
    console.log(e)
    if("error" in e && e.error != null) var text = e.error.stack
    else var text = e.message
    var alert = $(`<pre class="alert alert-danger" role="alert"></pre>`)
        .text(text)
    $("#flowium-error-text").append(alert)
    $("#flowium-error").show()
})

////////////////////////////////////////////////////////////////////////////////
// Main.
////////////////////////////////////////////////////////////////////////////////

$(document).ready(function() {
    // This page deliberately doesn't do authorization so that even the users
    // who haven't authorized Flowium can still read the documentation.

    //var addr = 'issue.html' +
    //    '?repository=' + encodeURIComponent("sustrik/flowium-sandbox") +
    //    '&template=' + encodeURIComponent("/shopping-list.md") + "&title=" + encodeURIComponent("My shopping list") + "&comment=" + encodeURIComponent("Go shopping!")
    //console.log(addr)

    $("#back-to-index").click(function () {
        window.location.href = "index.html"
    })

    $(".section-body").hide()
    $(".section-header").click(function () {
        var hidden = $(this).next().is(":hidden")
        $(".section-body").hide()
        if(hidden) $(this).next().show()
    })
    $("#intro").append(mdConvert(intro))
    $("#shoping").append(mdConvert(shoping))
    $("#responsibility").append(mdConvert(responsibility))
    $("#communication").append(mdConvert(communication))
    $("#audit").append(mdConvert(audit))
    $("#dependencies").append(mdConvert(dependencies))
    $("#parallel").append(mdConvert(parallel))
    $("#variables").append(mdConvert(variables))
    $("#versioning").append(mdConvert(versioning))
    $("#editing").append(mdConvert(editing))

    // Now the page is fully loaded, so show it to the user.
    $("#flowium-all").show()
})

</script>
<body>
  
<div id="flowium-all" class="container-fluid" style="display: none;">

  <h1 class="flowium-title">Flowium (Beta)
    <small>
      <i id="back-to-index" class="float-right fa fa-close cancel-icon"></i>
    </small>
  </h1>

  <div class="container tab-pane active"><br>

    <div class="card flowium-step">
      <div class="card-header flowium-card-header section-header">
        <h5 class="step-title">What is Flowium?</h5>
      </div>
      <div id="intro" class="card-body section-body step-body"></div>
    </div>

    <div class="card flowium-step">
      <div class="card-header flowium-card-header section-header">
        <h5 class="step-title">Shoping list</h5>
      </div>
      <div id="shoping" class="card-body section-body step-body"></div>
    </div>

    <div class="card flowium-step">
      <div class="card-header flowium-card-header section-header">
        <h5 class="step-title">With great power comes great responsibility</h5>
      </div>
      <div id="responsibility" class="card-body section-body step-body"></div>
    </div>

    <div class="card flowium-step">
      <div class="card-header flowium-card-header section-header">
        <h5 class="step-title">Flowium as a communication tool</h5>
      </div>
      <div id="communication" class="card-body section-body step-body"></div>
    </div>

    <div class="card flowium-step">
      <div class="card-header flowium-card-header section-header">
        <h5 class="step-title">Flowium as an audit trail</h5>
      </div>
      <div id="audit" class="card-body section-body step-body"></div>
    </div>

    <div class="card flowium-step">
      <div class="card-header flowium-card-header section-header">
        <h5 class="step-title">Managing dependencies</h5>
      </div>
      <div id="dependencies" class="card-body section-body step-body"></div>
    </div>

    <div class="card flowium-step">
      <div class="card-header flowium-card-header section-header">
        <h5 class="step-title">Parallel flows</h5>
      </div>
      <div id="parallel" class="card-body section-body step-body"></div>
    </div>

    <div class="card flowium-step">
      <div class="card-header flowium-card-header section-header">
        <h5 class="step-title">Gathering user input</h5>
      </div>
      <div id="variables" class="card-body section-body step-body"></div>
    </div>

    <div class="card flowium-step">
      <div class="card-header flowium-card-header section-header">
        <h5 class="step-title">Versioning of the processes</h5>
      </div>
      <div id="versioning" class="card-body section-body step-body"></div>
    </div>

    <div class="card flowium-step">
      <div class="card-header flowium-card-header section-header">
        <h5 class="step-title">Editing the processes</h5>
      </div>
      <div id="editing" class="card-body section-body step-body"></div>
    </div>

  </div>
</div>

<div id="flowium-error" class="container-fluid" style="display: none;">
    <br>
    <h3>Flowium encountered an error</h3>
    <br>
    <div id="flowium-error-text"></div>
    <p>If this doesn't look like a user error please do
      <a href="https://github.com/sustrik/flowium/issues/new"
          target="_blank">report the problem</a>.
    </p>
</div>

</body>
</html>
