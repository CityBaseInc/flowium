<!DOCTYPE html>
<html lang="en">
<head>
  <title>flowium</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="flowium.css">
  <script src="utils.js"></script>
</head>
<script>

intro = `
In the IT industry there is certain kind of processes that are rarely executed
without a lot of troubles. They are complex, volatile, often vaguely defined
and sometimes long-lived processes with many participants. They are
processes like "How to get a new major release out of the door?", "How to
reconfigure the company network?" or "How to build a new datacenter?"

These processes require a huge amount of highly technical knowledge, yet they
are rarely documented and even if they are the documentation is often couple
of years out of date. The knowledge is passed down by oral tradition, it
gradually dissipates and when people leave the company it is lost forever.

Flowium is an attempt to help with this problem. It assumes that the process
is written down as a markdown document. Then it turns the document into a tool
to guide people through the process, to track what has already been done, to
collect all the available context and to provide a well-defined communication
channel for all the participants in the process. Last but not least it tries
to encourage updating and maintenance of the original markdown document.

Technically, Flowium is a thin shim on top of GitHub issue tracker. It runs
entirely in the user's browser and speaks only to GitHub at the backend.
`

shoping = `
Let's start with the most trivial example. A list of items to buy at a grocery.
Here's the markdown document:

\`\`\`
# Bread

Choose a nice, crusty one.

# Butter

Don't buy to much of it else it'll get stale.

# Jam

Either strawberry or raspberry jam.
\`\`\`

You are supposed to upload your document to your GitHub repository, however,
the examples in this tutorial have already been uploaded for you, so you can
[start shopping straight away](index.html?action=create&repository=sustrik%2Fflowium-sandbox&template=%2Fshopping-list.md&title=My%20shopping%20list&comment=Go%20shopping!).
`

////////////////////////////////////////////////////////////////////////////////
//  Error handling.
////////////////////////////////////////////////////////////////////////////////

window.addEventListener('error', function (e) {
    $("#flowium-all").hide()
    console.log(e)
    if("error" in e && e.error != null) var text = e.error.stack
    else var text = e.message
    var alert = $(`<pre class="alert alert-danger" role="alert"></pre>`)
        .text(text)
    $("#flowium-error-text").append(alert)
    $("#flowium-error").show()
})

////////////////////////////////////////////////////////////////////////////////
// Main.
////////////////////////////////////////////////////////////////////////////////

$(document).ready(function() {
    // This page deliberately doesn't do authorization so that even the users
    // who haven't authorized Flowium can still read the documentation.

    var addr = 'issue.html' +
        '?repository=' + encodeURIComponent("sustrik/flowium-sandbox") +
        '&template=' + encodeURIComponent("/shopping-list.md") + "&title=" + encodeURIComponent("My shopping list") + "&comment=" + encodeURIComponent("Go shopping!")
    console.log(addr)

    $("#back-to-index").click(function () {
        window.location.href = "index.html"
    })

    $(".section-body").hide()
    $(".section-header").click(function () {
        var hidden = $(this).next().is(":hidden")
        $(".section-body").hide()
        if(hidden) $(this).next().show()
    })
    $("#intro").append(mdConvert(intro))
    $("#shoping").append(mdConvert(shoping))

    // Now the page is fully loaded, so show it to the user.
    $("#flowium-all").show()
})

</script>
<body>
  
<div id="flowium-all" class="container-fluid" style="display: none;">

  <h1 class="flowium-title">Flowium (Under construction)
    <small>
      <i id="back-to-index" class="float-right fa fa-close cancel-icon"></i>
    </small>
  </h1>

  <div class="container tab-pane active"><br>
    <div class="card flowium-step">
      <div class="card-header flowium-card-header section-header">
        <h5 class="step-title">What is Flowium?</h5>
      </div>
      <div id="intro" class="card-body section-body step-body"></div>
    </div>
    <div class="card flowium-step">
      <div class="card-header flowium-card-header section-header">
        <h5 class="step-title">Shoping list</h5>
      </div>
      <div id="shoping" class="card-body section-body step-body"></div>
    </div>
  </div>
</div>

<div id="flowium-error" class="container-fluid" style="display: none;">
    <br>
    <h3>Flowium encountered an error</h3>
    <br>
    <div id="flowium-error-text"></div>
    <p>If this doesn't look like a user error please do
      <a href="https://github.com/sustrik/flowium/issues/new"
          target="_blank">report the problem</a>.
    </p>
</div>

</body>
</html>
